"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[6388],{28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>s});var i=t(96540);const o={},r=i.createContext(o);function a(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),i.createElement(r.Provider,{value:n},e.children)}},56656:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"patterns/write_protect_config_node","title":"Read-only config","description":"Example application","source":"@site/versioned_docs/version-1.0/patterns/write_protect_config_node.md","sourceDirName":"patterns","slug":"/patterns/write_protect_config_node","permalink":"/docs/1.0/patterns/write_protect_config_node","draft":false,"unlisted":false,"editUrl":"https://github.com/facebookresearch/hydra/edit/main/website/versioned_docs/version-1.0/patterns/write_protect_config_node.md","tags":[],"version":"1.0","lastUpdatedBy":"jesszzzz","lastUpdatedAt":1755026473000,"frontMatter":{"id":"write_protect_config_node","title":"Read-only config"},"sidebar":"docs","previous":{"title":"Specializing configuration","permalink":"/docs/1.0/patterns/specializing_config"},"next":{"title":"Introduction","permalink":"/docs/1.0/configure_hydra/intro"}}');var o=t(74848),r=t(28453);const a={id:"write_protect_config_node",title:"Read-only config"},s=void 0,c={},l=[{value:"Problem",id:"problem",level:3},{value:"Solution",id:"solution",level:3}];function d(e){const n={a:"a",code:"code",h3:"h3",img:"img",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:(0,o.jsx)(n.a,{href:"https://github.com/facebookresearch/hydra/tree/1.0_branch/examples/patterns/write_protect_config_node",children:(0,o.jsx)(n.img,{src:"https://img.shields.io/badge/-Example%20application-informational",alt:"Example application"})})}),"\n",(0,o.jsx)(n.h3,{id:"problem",children:"Problem"}),"\n",(0,o.jsx)(n.p,{children:"Sometimes you want to prevent a config node from being changed accidentally."}),"\n",(0,o.jsx)(n.h3,{id:"solution",children:"Solution"}),"\n",(0,o.jsxs)(n.p,{children:["Structured Configs can enable it by passing ",(0,o.jsx)(n.a,{href:"https://omegaconf.readthedocs.io/en/latest/structured_config.html#frozen",children:"frozen=True"})," in the dataclass definition.\nUsing Structured Configs, you can annotate a dataclass as frozen. This is recursive and applies to all child nodes."]}),"\n",(0,o.jsx)(n.p,{children:"This will prevent modifications via code, command line overrides and config composition."}),"\n",(0,o.jsxs)("div",{className:"row",children:[(0,o.jsx)("div",{className:"col col--6",children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",metastring:'title="frozen.py" {1}',children:'@dataclass(frozen=True)\nclass SerialPort:\n    baud_rate: int = 19200\n    data_bits: int = 8\n    stop_bits: int = 1\n\n\ncs = ConfigStore.instance()\ncs.store(name="config", node=SerialPort)\n\n\n@hydra.main(config_name="config")\ndef my_app(cfg: SerialPort) -> None:\n    print(cfg)\n\n\nif __name__ == "__main__":\n    my_app()\n'})})}),(0,o.jsx)("div",{className:"col  col--6",children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",metastring:'script title="Output"',children:"$ python frozen.py data_bits=10\nError merging override data_bits=10\nCannot change read-only config container\n    full_key: data_bits\n    reference_type=Optional[SerialPort]\n    object_type=SerialPort\n"})})})]}),"\n",(0,o.jsx)("div",{class:"alert alert--warning",role:"alert",children:(0,o.jsxs)(n.p,{children:[(0,o.jsx)("strong",{children:"NOTE"}),":\nA crafty user can find many ways around this. this is just making it harder to change things accidentally."]})})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}}}]);