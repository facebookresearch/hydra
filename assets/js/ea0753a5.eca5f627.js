"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[2343],{28453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>l});var s=r(96540);const i={},t=s.createContext(i);function a(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(t.Provider,{value:n},e.children)}},49595:(e,n,r)=>{r.d(n,{A:()=>o,C:()=>c});r(96540);var s=r(28774),i=r(44586),t=r(48295),a=r(74848);function l(e){const n=(0,t.ir)();return(0,i.default)().siteConfig.customFields.githubLinkVersionToBaseUrl[n?.name??"current"]+e}function o(e){return(0,a.jsx)(s.default,{...e,to:l(e.to),target:"_blank"})}function c(e){const n=e.text??"Example (Click Here)";return(0,a.jsxs)(o,{...e,children:[(0,a.jsx)("span",{children:"\xa0"}),(0,a.jsx)("img",{src:"https://img.shields.io/badge/-"+n+"-informational",alt:"Example (Click Here)"})]})}},83885:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"plugins/rq_launcher","title":"RQ Launcher plugin","description":"PyPI","source":"@site/versioned_docs/version-1.3/plugins/rq_launcher.md","sourceDirName":"plugins","slug":"/plugins/rq_launcher","permalink":"/docs/1.3/plugins/rq_launcher","draft":false,"unlisted":false,"editUrl":"https://github.com/facebookresearch/hydra/edit/main/website/versioned_docs/version-1.3/plugins/rq_launcher.md","tags":[],"version":"1.3","lastUpdatedBy":"jesszzzz","lastUpdatedAt":1754333694000,"frontMatter":{"id":"rq_launcher","title":"RQ Launcher plugin","sidebar_label":"RQ Launcher plugin"},"sidebar":"docs","previous":{"title":"Ray Launcher plugin","permalink":"/docs/1.3/plugins/ray_launcher"},"next":{"title":"Submitit Launcher plugin","permalink":"/docs/1.3/plugins/submitit_launcher"}}');var i=r(74848),t=r(28453),a=r(49595);const l={id:"rq_launcher",title:"RQ Launcher plugin",sidebar_label:"RQ Launcher plugin"},o=void 0,c={},d=[{value:"Installation",id:"installation",level:3},{value:"Usage",id:"usage",level:3}];function h(e){const n={a:"a",code:"code",h3:"h3",img:"img",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://pypi.org/project/hydra-rq-launcher/",children:(0,i.jsx)(n.img,{src:"https://img.shields.io/pypi/v/hydra-rq-launcher",alt:"PyPI"})}),"\n",(0,i.jsx)(n.img,{src:"https://img.shields.io/pypi/l/hydra-rq-launcher",alt:"PyPI - License"}),"\n",(0,i.jsx)(n.img,{src:"https://img.shields.io/pypi/pyversions/hydra-rq-launcher",alt:"PyPI - Python Version"}),"\n",(0,i.jsx)(n.a,{href:"https://pypistats.org/packages/hydra-rq-launcher",children:(0,i.jsx)(n.img,{src:"https://img.shields.io/pypi/dm/hydra-rq-launcher.svg",alt:"PyPI - Downloads"})}),(0,i.jsx)(a.C,{text:"Example application",to:"plugins/hydra_rq_launcher/examples"}),(0,i.jsx)(a.C,{text:"Plugin source",to:"plugins/hydra_rq_launcher"})]}),"\n",(0,i.jsxs)(n.p,{children:["The RQ Launcher plugin provides a launcher for distributed execution and job queuing based on ",(0,i.jsx)(n.a,{href:"https://python-rq.org",children:"Redis Queue (RQ)"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["RQ launcher allows parallelizing across multiple nodes and scheduling jobs in queues. Usage of this plugin requires a ",(0,i.jsx)(n.a,{href:"https://redis.io/topics/quickstart",children:"Redis server"}),". When parallelisation on a single node is intended, the Joblib launcher may be preferable, since it works without a database."]}),"\n",(0,i.jsx)(n.h3,{id:"installation",children:"Installation"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-commandline",children:"pip install hydra-rq-launcher --upgrade\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Usage of this plugin requires a ",(0,i.jsx)(n.a,{href:"https://redis.io/topics/quickstart",children:"Redis server"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Note that RQ does ",(0,i.jsx)(n.a,{href:"https://python-rq.org/docs/#limitations",children:"not support Windows"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"usage",children:"Usage"}),"\n",(0,i.jsxs)(n.p,{children:["Once installed, add ",(0,i.jsx)(n.code,{children:"hydra/launcher=rq"})," to your command line. Alternatively, override ",(0,i.jsx)(n.code,{children:"hydra/launcher"})," in your config:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"defaults:\n  - override hydra/launcher: rq\n"})}),"\n",(0,i.jsx)(n.p,{children:"The default configuration is as follows:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:'title="$ python your_app.py hydra/launcher=rq --cfg hydra -p hydra.launcher"',children:"# @package hydra.launcher\n_target_: hydra_plugins.hydra_rq_launcher.rq_launcher.RQLauncher\nenqueue:\n  job_timeout: null\n  ttl: null\n  result_ttl: null\n  failure_ttl: null\n  at_front: false\n  job_id: null\n  description: null\nqueue: default \nredis:\n  host: ${oc.env:REDIS_HOST,localhost}\n  port: ${oc.env:REDIS_PORT,6379}\n  db: ${oc.env:REDIS_DB,0}\n  password: ${oc.env:REDIS_PASSWORD,null}\n  ssl: ${oc.env:REDIS_SSL,False}\n  ssl_ca_certs: ${oc.env:REDIS_SSL_CA_CERTS,null\n  mock: ${oc.env:REDIS_MOCK,False}\nstop_after_enqueue: false\nwait_polling: 1.0\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Further descriptions on the variables can be found in the plugin config file, defined ",(0,i.jsx)(a.A,{to:"plugins/hydra_rq_launcher/hydra_plugins/hydra_rq_launcher/config.py",children:"here"}),". There are several standard approaches for configuring plugins. Check ",(0,i.jsx)(n.a,{href:"/docs/1.3/patterns/configuring_plugins",children:"this page"})," for more information."]}),"\n",(0,i.jsxs)(n.p,{children:["The plugin is using environment variables to store Redis connection information. The environment variables ",(0,i.jsx)(n.code,{children:"REDIS_HOST"}),", ",(0,i.jsx)(n.code,{children:"REDIS_PORT"}),", ",(0,i.jsx)(n.code,{children:"REDIS_DB"}),", and ",(0,i.jsx)(n.code,{children:"REDIS_PASSWORD"}),", are used for the host address, port, database, and password of the server, respectively. Support for Redis SSL connections is controlled through ",(0,i.jsx)(n.code,{children:"REDIS_SSL"})," and ",(0,i.jsx)(n.code,{children:"REDIS_SSL_CA_CERTS"}),"; see ",(0,i.jsx)(n.a,{href:"https://github.com/andymccurdy/redis-py#ssl-connections",children:"redis-py"})," documentation."]}),"\n",(0,i.jsxs)(n.p,{children:["For example, they might be set as follows when using ",(0,i.jsx)(n.code,{children:"bash"})," or ",(0,i.jsx)(n.code,{children:"zsh"})," as a shell:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-commandline",children:'export REDIS_HOST="localhost"\nexport REDIS_PORT="6379"\nexport REDIS_DB="0"\nexport REDIS_PASSWORD=""\n'})}),"\n",(0,i.jsx)(n.p,{children:"Enable SSL by setting the relevant environment variables. e.g:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-commandline",children:"export REDIS_SSL=true\nexport REDIS_SSL_CA_CERTS=/etc/ssl/certs/ca-certificates.crt\n"})}),"\n",(0,i.jsx)(n.p,{children:"Assuming configured environment variables, workers connecting to the Redis server can be launched using:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-commandline",children:"rq worker --url redis://:$REDIS_PASSWORD@$REDIS_HOST:$REDIS_PORT/$REDIS_DB\n"})}),"\n",(0,i.jsxs)(n.p,{children:["An ",(0,i.jsx)(a.A,{to:"plugins/hydra_rq_launcher/example",children:"example application"})," using this launcher is provided in the plugin repository."]}),"\n",(0,i.jsxs)(n.p,{children:["Starting the app with ",(0,i.jsx)(n.code,{children:"python my_app.py --multirun task=1,2,3,4,5"})," will enqueue five jobs to be processed by worker instances:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"$ python my_app.py --multirun task=1,2,3,4,5\n\n[HYDRA] RQ Launcher is enqueuing 5 job(s) in queue : default\n[HYDRA] Sweep output dir : multirun/2020-06-15/18-00-00\n[HYDRA] Enqueued 13b3da4e-03f7-4d16-9ca8-cfb3c48afeae\n[HYDRA] \t#1 : task=1\n[HYDRA] Enqueued 00c6a32d-e5a4-432c-a0f3-b9d4ef0dd585\n[HYDRA] \t#2 : task=2\n[HYDRA] Enqueued 63b90f27-0711-4c95-8f63-70164fd850df\n[HYDRA] \t#3 : task=3\n[HYDRA] Enqueued b1d49825-8b28-4516-90ca-8106477e1eb1\n[HYDRA] \t#4 : task=4\n[HYDRA] Enqueued ed96bdaa-087d-4c7f-9ecb-56daf948d5e2\n[HYDRA] \t#5 : task=5\n[HYDRA] Finished enqueuing\n[HYDRA] Polling job statuses every 1.0 sec\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Note that any dependencies need to be installed in the Python environment used to run the RQ worker. For serialization of jobs ",(0,i.jsx)(n.a,{href:"https://github.com/cloudpickle/cloudpickle",children:(0,i.jsx)(n.code,{children:"cloudpickle"})})," is used."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.a,{href:"https://python-rq.org/",children:"RQ documentation"})," holds further information on ",(0,i.jsx)(n.a,{href:"http://python-rq.org/docs/monitoring/",children:"job monitoring"}),", which can be done via console or ",(0,i.jsx)(n.a,{href:"https://github.com/nvie/rq-dashboard",children:"web interfaces"}),", and provides ",(0,i.jsx)(n.a,{href:"https://python-rq.org/patterns/",children:"patterns"})," for worker and exception handling."]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}}}]);