"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[512],{28453:(e,n,a)=>{a.d(n,{R:()=>t,x:()=>o});var i=a(96540);const r={},s=i.createContext(r);function t(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(s.Provider,{value:n},e.children)}},57830:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"plugins/ax_sweeper","title":"Ax Sweeper plugin","description":"PyPI","source":"@site/versioned_docs/version-1.0/plugins/ax_sweeper.md","sourceDirName":"plugins","slug":"/plugins/ax_sweeper","permalink":"/docs/1.0/plugins/ax_sweeper","draft":false,"unlisted":false,"editUrl":"https://github.com/facebookresearch/hydra/edit/main/website/versioned_docs/version-1.0/plugins/ax_sweeper.md","tags":[],"version":"1.0","lastUpdatedBy":"zhenbang-2026","lastUpdatedAt":1757109332000,"frontMatter":{"id":"ax_sweeper","title":"Ax Sweeper plugin","sidebar_label":"Ax Sweeper plugin"},"sidebar":"docs","previous":{"title":"Submitit Launcher plugin","permalink":"/docs/1.0/plugins/submitit_launcher"},"next":{"title":"Nevergrad Sweeper plugin","permalink":"/docs/1.0/plugins/nevergrad_sweeper"}}');var r=a(74848),s=a(28453);const t={id:"ax_sweeper",title:"Ax Sweeper plugin",sidebar_label:"Ax Sweeper plugin"},o=void 0,l={},c=[{value:"Installation",id:"installation",level:3},{value:"Usage",id:"usage",level:3}];function d(e){const n={a:"a",code:"code",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://img.shields.io/pypi/v/hydra-ax-sweeper",children:(0,r.jsx)(n.img,{src:"https://img.shields.io/pypi/v/hydra-ax-sweeper",alt:"PyPI"})}),"\n",(0,r.jsx)(n.img,{src:"https://img.shields.io/pypi/l/hydra-ax-sweeper",alt:"PyPI - License"}),"\n",(0,r.jsx)(n.img,{src:"https://img.shields.io/pypi/pyversions/hydra-ax-sweeper",alt:"PyPI - Python Version"}),"\n",(0,r.jsx)(n.a,{href:"https://pypistats.org/packages/hydra-ax-sweeper",children:(0,r.jsx)(n.img,{src:"https://img.shields.io/pypi/dm/hydra-ax-sweeper.svg",alt:"PyPI - Downloads"})}),"\n",(0,r.jsx)(n.a,{href:"https://github.com/facebookresearch/hydra/tree/1.0_branch/plugins/hydra_ax_sweeper/example",children:(0,r.jsx)(n.img,{src:"https://img.shields.io/badge/-Example%20application-informational",alt:"Example application"})}),"\n",(0,r.jsx)(n.a,{href:"https://github.com/facebookresearch/hydra/tree/1.0_branch/plugins/hydra_ax_sweeper",children:(0,r.jsx)(n.img,{src:"https://img.shields.io/badge/-Plugin%20source-informational",alt:"Plugin source"})})]}),"\n",(0,r.jsxs)(n.p,{children:["This plugin provides a mechanism for Hydra applications to use the ",(0,r.jsx)(n.a,{href:"https://ax.dev/",children:"Adaptive Experimentation Platform, aka Ax"}),". Ax can optimize any experiment - machine learning experiments, A/B tests, and simulations."]}),"\n",(0,r.jsx)(n.h3,{id:"installation",children:"Installation"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-commandline",children:"pip install hydra-ax-sweeper --upgrade\n"})}),"\n",(0,r.jsx)(n.h3,{id:"usage",children:"Usage"}),"\n",(0,r.jsxs)(n.p,{children:["Once installed, add ",(0,r.jsx)(n.code,{children:"hydra/sweeper=ax"})," to your command line. Alternatively, override ",(0,r.jsx)(n.code,{children:"hydra/sweeper"})," in your config:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"defaults:\n  - hydra/sweeper: ax\n"})}),"\n",(0,r.jsxs)(n.p,{children:["We include an example of how to use this plugin. The file ",(0,r.jsx)(n.a,{href:"https://github.com/facebookresearch/hydra/blob/master/plugins/hydra_ax_sweeper/example/banana.py",children:(0,r.jsx)(n.code,{children:"example/banana.py"})})," implements the ",(0,r.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Rosenbrock_function",children:"Rosenbrock function (aka Banana function)"}),". The return value of the function should be the value that we want to optimize."]}),"\n",(0,r.jsxs)(n.p,{children:["To compute the best parameters for the Banana function, clone the code and run the following command in the ",(0,r.jsx)(n.code,{children:"plugins/hydra_ax_sweeper"})," directory:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"python example/banana.py -m 'banana.x=int(interval(-5, 5))' 'banana.y=interval(-5, 10.1)'\n"})}),"\n",(0,r.jsx)(n.p,{children:"The output of a run looks like:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[HYDRA] AxSweeper is optimizing the following parameters:\nbanana.x: range=[-5, 5], type = int\nbanana.y: range=[-5.0, 10.1], type = float\nax.modelbridge.dispatch_utils: Using Bayesian Optimization generation strategy: GenerationStrategy(name='Sobol+GPEI', steps=[Sobol for 5 arms, GPEI for subsequent arms], generated 0 arm(s) so far). Iterations after 5 will take longer to generate due to model-fitting.\nAxSweeper is launching 5 jobs\n[HYDRA] Launching 5 jobs locally\n[HYDRA]   #0 : banana.x=4 banana.y=-1.484\n[__main__][INFO] - Banana_Function(x=4, y=-1.484)=30581.473\n[HYDRA]   #1 : banana.x=3 banana.y=-3.653\n[__main__][INFO] - Banana_Function(x=3, y=-3.653)=16014.261\n[HYDRA]   #2 : banana.x=0 banana.y=9.409\n[__main__][INFO] - Banana_Function(x=0, y=9.409)=8855.340\n[HYDRA]   #3 : banana.x=-4 banana.y=2.059\n[__main__][INFO] - Banana_Function(x=-4, y=2.059)=19459.063\n[HYDRA]   #4 : banana.x=-3 banana.y=-1.338\n[__main__][INFO] - Banana_Function(x=-3, y=-1.338)=10704.497\n[HYDRA] New best value: 8855.340, best parameters: {'banana.x': 0, 'banana.y': 9.409}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["In this example, we set the range of ",(0,r.jsx)(n.code,{children:"x"})," parameter as an integer in the interval ",(0,r.jsx)(n.code,{children:"[-5, 5]"})," and the range of ",(0,r.jsx)(n.code,{children:"y"})," parameter as a float in the interval ",(0,r.jsx)(n.code,{children:"[-5, 10.1]"}),". Note that in the case of ",(0,r.jsx)(n.code,{children:"x"}),", we used ",(0,r.jsx)(n.code,{children:"int(interval(...))"})," and hence only integers are sampled. In the case of ",(0,r.jsx)(n.code,{children:"y"}),", we used ",(0,r.jsx)(n.code,{children:"interval(...)"})," which refers to a floating-point interval. Other supported formats are fixed parameters (e.g.",(0,r.jsx)(n.code,{children:" banana.x=5.0"}),"), choice parameters (eg ",(0,r.jsx)(n.code,{children:"banana.x=choice(1,2,3)"}),") and range (eg ",(0,r.jsx)(n.code,{children:"banana.x=range(1, 10)"}),"). Note that ",(0,r.jsx)(n.code,{children:"interval"}),", ",(0,r.jsx)(n.code,{children:"choice"})," etc. are functions provided by Hydra, and you can read more about them ",(0,r.jsx)(n.a,{href:"/docs/1.0/advanced/override_grammar/extended",children:"here"}),". An important thing to remember is, use ",(0,r.jsx)(n.a,{href:"/docs/1.0/advanced/override_grammar/extended#interval-sweep",children:(0,r.jsx)(n.code,{children:"interval"})})," when we want Ax to sample values from an interval. ",(0,r.jsx)(n.a,{href:"https://ax.dev/api/ax.html#ax.RangeParameter",children:(0,r.jsx)(n.code,{children:"RangeParameter"})})," in Ax is equivalent to ",(0,r.jsx)(n.code,{children:"interval"})," in Hydra. Remember to use ",(0,r.jsx)(n.code,{children:"int(interval(...))"})," if you want to sample only integer points from the interval. ",(0,r.jsx)(n.a,{href:"/docs/1.0/advanced/override_grammar/extended#range-sweep",children:(0,r.jsx)(n.code,{children:"range"})})," can be used as an alternate way of specifying choice parameters. For example ",(0,r.jsx)(n.code,{children:"python example/banana.py -m banana.x=choice(1, 2, 3, 4)"})," is equivalent to ",(0,r.jsx)(n.code,{children:"python example/banana.py -m banana.x=range(1, 5)"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["The values of the ",(0,r.jsx)(n.code,{children:"x"})," and ",(0,r.jsx)(n.code,{children:"y"})," parameters can also be set using the config file ",(0,r.jsx)(n.code,{children:"plugins/hydra_ax_sweeper/example/conf/config.yaml"}),". For instance, the configuration corresponding to the commandline arguments is as follows:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"banana.x:\n type: range\n bounds: [-5, 5]\n\nbanana.y:\n type: range\n bounds: [-5, 10.1]\n"})}),"\n",(0,r.jsxs)(n.p,{children:["In general, the plugin supports setting all the Ax supported ",(0,r.jsx)(n.a,{href:"https://ax.dev/api/core.html?highlight=range#module-ax.core.parameter",children:"Parameters"})," in the config. According to the ",(0,r.jsx)(n.a,{href:"https://ax.dev/api/service.html#ax.service.ax_client.AxClient.create_experiment",children:"Ax documentation"}),", the required elements in the config are:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"name"})," - Name of the parameter. It is of type string."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"type"})," - Type of the parameter. It can take the following values: ",(0,r.jsx)(n.code,{children:"range"}),", ",(0,r.jsx)(n.code,{children:"fixed"}),", or ",(0,r.jsx)(n.code,{children:"choice"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"bounds"})," - Required only for the ",(0,r.jsx)(n.code,{children:"range"})," parameters. It should be a list of two values, with the lower bound first."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"values"})," - Required only for the ",(0,r.jsx)(n.code,{children:"choice"})," parameters. It should be a list of values."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"value"})," - Required only for the ",(0,r.jsx)(n.code,{children:"fixed"})," parameters. It should be a single value."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Note that if you want to sample integers in the range ",(0,r.jsx)(n.code,{children:"-5"})," to ",(0,r.jsx)(n.code,{children:"5"}),", you need to specify the range as ",(0,r.jsx)(n.code,{children:"int(interval(-5, 5))"})," (in the command line) or ",(0,r.jsx)(n.code,{children:"[-5, 5]"})," (in config). If you want to sample floats in range ",(0,r.jsx)(n.code,{children:"-5"})," to ",(0,r.jsx)(n.code,{children:"5"}),", you need to specify the range as ",(0,r.jsx)(n.code,{children:"interval(-5, 5)"})," (in the command line) or ",(0,r.jsx)(n.code,{children:"[-5.0, 5.0]"})," (in config)."]}),"\n",(0,r.jsx)(n.p,{children:"The parameters for the optimization process can also be set in the config file. Specifying the Ax config is optional. You can discover the Ax Sweeper parameters with:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="$ python your_app.py hydra/sweeper=ax --cfg hydra -p hydra.sweeper"',children:"# @package hydra.sweeper\n_target_: hydra_plugins.hydra_ax_sweeper.ax_sweeper.AxSweeper\nmax_batch_size: null\nax_config:\n  max_trials: 10\n  early_stop:\n    minimize: true\n    max_epochs_without_improvement: 10\n    epsilon: 1.0e-05\n  experiment:\n    name: null\n    objective_name: objective\n    minimize: true\n    parameter_constraints: null\n    outcome_constraints: null\n    status_quo: null\n  client:\n    verbose_logging: false\n    random_seed: null\n  params: {}\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);