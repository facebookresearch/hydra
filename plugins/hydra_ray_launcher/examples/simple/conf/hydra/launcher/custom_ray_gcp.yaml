defaults:
  - ray_gcp

env_setup:
  commands:
    - >-
      wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh
      -O conda_installer.sh
    - sudo bash conda_installer.sh -u -b -p /opt/conda && rm conda_installer.sh
    - /opt/conda/bin/conda init
    - sudo apt update && sudo apt install -y default-jre build-essential
    - >-
      conda create -n hydra_${python_version:micro}
      python=${python_version:micro} -y
    - >-
      echo 'export
      PATH="$HOME/anaconda3/envs/hydra_${python_version:micro}/bin:$PATH"'
      >> ~/.bashrc
    - >-
      pip install
      git+https://github.com/icgrp/hydra.git@ray-cluster-sdk#egg=hydra-core
    - >-
      pip install
      git+https://github.com/icgrp/hydra.git@ray-cluster-sdk#egg=hydra-ray-launcher\&subdirectory=plugins/hydra_ray_launcher
  pip_packages:
    cloudpickle: '${ray_pkg_version:cloudpickle}'
    hydra_core: null
    hydra_ray_launcher: null
    omegaconf: '${ray_pkg_version:omegaconf}'
    pickle5: 0.0.11
    ray: '${ray_pkg_version:ray}'
ray:
  cluster:
    auth:
      ssh_user: stahmed_seas_upenn_edu
    provider:
      type: gcp
      region: us-central1
      availability_zone: us-central1-a
      project_id: trim-modem-277014
