<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.64">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-149862507-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="Hydra" href="/opensearch.xml"><title data-react-helmet="true">Hydra Ray Launcher | Hydra</title><meta data-react-helmet="true" property="og:title" content="Hydra Ray Launcher | Hydra"><meta data-react-helmet="true" name="description" content="We are happy to announce that we are adding a Ray Launcher to the Hydra Launchers family."><meta data-react-helmet="true" property="og:description" content="We are happy to announce that we are adding a Ray Launcher to the Hydra Launchers family."><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://hydra.cc/img/Hydra-Readme-logo2.svg"><meta data-react-helmet="true" property="twitter:image" content="https://hydra.cc/img/Hydra-Readme-logo2.svg"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for Hydra Ray Launcher"><link data-react-helmet="true" rel="shortcut icon" href="/img/Hydra-head.svg"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="true"><link rel="stylesheet" href="/styles.798995d3.css">
<link rel="preload" href="/styles.ef4286b7.js" as="script">
<link rel="preload" href="/runtime~main.35e28769.js" as="script">
<link rel="preload" href="/main.400321a3.js" as="script">
<link rel="preload" href="/1.9ca0e889.js" as="script">
<link rel="preload" href="/2.1bf42f32.js" as="script">
<link rel="preload" href="/3.974e98df.js" as="script">
<link rel="preload" href="/ccc49370.6ea934d4.js" as="script">
<link rel="preload" href="/44267b07.43e76fc4.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="Hydra logo"><strong class="navbar__title">Hydra</strong></a><a class="navbar__item navbar__link" href="/docs/intro">Docs</a><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a class="navbar__item navbar__link" href="/docs/intro">1.0</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/intro">Next</a></li><li><a class="dropdown__link" href="/docs/intro">1.0</a></li><li><a class="dropdown__link" href="/docs/0.11/intro">0.11</a></li></ul></div><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a href="https://github.com/facebookresearch/hydra" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Hydra@GitHub</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">üåû</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">‚åò</span><span class="DocSearch-Button-Key">K</span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="Hydra logo"><strong class="navbar__title">Hydra</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro">Docs</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist">Versions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/next/intro">Next</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro">1.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/0.11/intro">0.11</a></li></ul></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/facebookresearch/hydra" target="_blank" rel="noopener noreferrer" class="menu__link">Hydra@GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><div class="col col--8 col--offset-2"><article><header><h1 class="margin-bottom--sm blogPostTitle_1mse">Hydra Ray Launcher</h1><div class="margin-vert--md"><time datetime="2020-12-22T00:00:00.000Z" class="blogPostDate_3bQP">December 22, 2020  ¬∑ 4 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/jieru-hu" target="_blank" rel="noreferrer noopener"><img src="https://graph.facebook.com/733244046/picture/?height=200&amp;width=200" alt="Jieru Hu"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/jieru-hu" target="_blank" rel="noreferrer noopener">Jieru Hu</a></h4><small class="avatar__subtitle"></small></div></div></header><section class="markdown"><p>We are happy to announce that we are adding a <a href="https://hydra.cc/docs/plugins/ray_launcher" target="_blank" rel="noopener noreferrer">Ray Launcher</a> to the Hydra Launchers family.
Hydra&#x27;s Launcher plugins enable launching to different environments without changing your existing workflows or application code.
The Hydra Ray Launcher can be used to launch your application to a new or existing <a href="https://docs.ray.io/en/master/cluster/launcher.html" target="_blank" rel="noopener noreferrer">Ray cluster</a>,
locally or on AWS. In this post we demonstrate the major functionalities of the Launcher.
For more details on installation and configuration, please check out the <a href="https://hydra.cc/docs/plugins/ray_launcher/" target="_blank" rel="noopener noreferrer">Hydra Ray Launcher documentation</a>.
As always, please <a href="https://github.com/facebookresearch/hydra#community" target="_blank" rel="noopener noreferrer">join our community</a> and give us feedback!</p><p><a href="https://github.com/ray-project/ray" target="_blank" rel="noopener noreferrer">Ray</a> is a simple yet powerful Python library for parallel and distributed programming. Among the many features it provides, Ray comes with a
<a href="https://docs.ray.io/en/master/cluster/launcher.html#ref-automatic-cluster" target="_blank" rel="noopener noreferrer">cluster launcher</a> that can be used to provision resources and start a Ray cluster on top of them.
Hydra Ray Launcher is built on top of the <a href="https://docs.ray.io/en/master/ray-overview/index.html#parallelizing-python-java-functions-with-ray-tasks" target="_blank" rel="noopener noreferrer">Ray Tasks API</a> and the Ray cluster launcher. </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="launching-to-a-new-or-existing-aws-cluster"></a>Launching to a new or existing AWS cluster<a aria-hidden="true" tabindex="-1" class="hash-link" href="#launching-to-a-new-or-existing-aws-cluster" title="Direct link to heading">#</a></h3><p>Hydra Ray Launcher simplifies your experience by allowing the Ray cluster setup to be
configured transparently by Hydra (eliminating the need for an external YAML file while maintaining
the flexibility). Hydra Ray Launcher comes with reasonable default configurations which can be found
<a href="https://hydra.cc/docs/plugins/ray_launcher/#ray_aws-launcher" target="_blank" rel="noopener noreferrer">here</a> (under the heading, ‚ÄúDiscover ray_aws launcher&#x27;s config‚Äù). You can override them in your application
config or from the command line to fit your use case.
The following Ray Launcher example code (e.g., my_app.py) is runnable and can be found <a href="https://github.com/facebookresearch/hydra/tree/master/plugins/hydra_ray_launcher/examples/simple" target="_blank" rel="noopener noreferrer">here</a>. </p><p>Launch your Hydra application to AWS by simply overriding: <code>hydra/launcher=ray_aws</code>:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-commandline codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ python my_app.py hydra/launcher=ray_aws task=1,2 --multirun</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[HYDRA] Ray Launcher is launching 2 jobs, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[HYDRA]        #0 : task=1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[HYDRA]        #1 : task=2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[HYDRA] Running command: [&#x27;ray&#x27;, &#x27;up&#x27;, &#x27;-y&#x27;, &#x27;/var/folders/n_/9qzct77j68j6n9lh0lw3vjqcn96zxl/T/tmp20qvoy15.yaml&#x27;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[HYDRA] Output: INFO services.py:1090 -- View the Ray dashboard at http://127.0.0.1:8265</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">(pid=3823)[__main__][INFO] - Executing task 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">(pid=3822)[__main__][INFO] - Executing task 2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[HYDRA] Stopping cluster now. (stop_cluster=true)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[HYDRA] Deleted the cluster (provider.cache_stopped_nodes=false)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[HYDRA] Running command: [&#x27;ray&#x27;, &#x27;down&#x27;, &#x27;-y&#x27;, &#x27;/var/folders/n_/9qzct77j68j6n9lh0lw3vjqcn96zxl/T/tmpfm2ems9v.yaml&#x27;]</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="launching-to-a-new-local-ray-cluster"></a>Launching to a new local Ray Cluster<a aria-hidden="true" tabindex="-1" class="hash-link" href="#launching-to-a-new-local-ray-cluster" title="Direct link to heading">#</a></h3><p>If you want to do a quick local test,
you can spin up a local Ray cluster at application run time by specifying <code>hydra/launcher=ray</code>.
In this example, we create a new Ray cluster at application time. </p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-commandline codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ python my_app.py  --multirun hydra/launcher=ray </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[HYDRA] Ray Launcher is launching 1 jobs, sweep output dir: multirun/2020-12-17/16-11-28</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[HYDRA] Initializing ray with config: {&#x27;address&#x27;: None}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">2020-12-17 16:11:29,340 INFO services.py:1090 -- View the Ray dashboard at http://127.0.0.1:8265</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[HYDRA]        #0 : </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">(pid=62642) [__main__][INFO] - Executing task 1</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="launching-to-an-existing-local-ray-cluster"></a>Launching to an existing local Ray Cluster<a aria-hidden="true" tabindex="-1" class="hash-link" href="#launching-to-an-existing-local-ray-cluster" title="Direct link to heading">#</a></h3><p>You can launch the application on an existing local Ray cluster by configuring the cluster address
and overriding <code>hydra/launcher=ray</code>. In the following example we configure the Ray cluster address
to local ray cluster and Hydra Ray Launcher was able to connect to the existing Ray cluster and
execute the application code:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-commandline codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ python my_app.py  --multirun hydra/launcher=ray hydra.launcher.ray.init.address=localhost:6379</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[HYDRA] Ray Launcher is launching 1 jobs, sweep output dir: multirun/2020-11-10/15-13-32</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[HYDRA] Initializing ray with config: {&#x27;num_cpus&#x27;: None, &#x27;num_gpus&#x27;: None, &#x27;address&#x27;: &#x27;localhost:6379&#x27;}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">INFO worker.py:633 -- Connecting to existing Ray cluster at address: 10.30.99.17:6379</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[HYDRA]        #0 :</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">(pid=93358) [__main__][INFO] - Executing task 1</span></div></div></div></div></div><p>Hydra Ray Launcher is built on top of Hydra 1.0 and you have access to all of the benefits Hydra brings:</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="parameter-sweeps-and-optimization"></a>Parameter sweeps and optimization<a aria-hidden="true" tabindex="-1" class="hash-link" href="#parameter-sweeps-and-optimization" title="Direct link to heading">#</a></h3><p>Hyperparameter sweeps are common in machine learning research.
Hydra has built-in grid search and provides several Sweeper plugins for hyperparameter optimization.
Sweepers can be used together with Launchers for sweeping on different computing platforms.
Start from our documentation <a href="https://hydra.cc/docs/tutorials/basic/running_your_app/multi-run/" target="_blank" rel="noopener noreferrer">here</a> to find more.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="config-type-safety"></a>Config type safety<a aria-hidden="true" tabindex="-1" class="hash-link" href="#config-type-safety" title="Direct link to heading">#</a></h3><p>Modern Hydra applications and Hydra Plugins leverage Structured Configs for config validation,
and Hydra Ray Launcher is no exception. In the following example, we try to override the Ray cluster‚Äôs
autoscaling mode with an illegal value:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-commandline codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ python my_app.py --multirun hydra.launcher.ray.cluster.autoscaling_mode=foo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Error merging override hydra.launcher.ray.cluster.autoscaling_mode=foo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Invalid value &#x27;foo&#x27;, expected one of [default, aggressive]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        full_key: hydra.launcher.ray.cluster.autoscaling_mode</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        reference_type=RayClusterConf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        object_type=RayClusterConf</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.</span></div></div></div></div></div><p>That‚Äôs it for now! Please try out the new Hydra Ray Launcher and let us know what you think.
We are always happy to connect with you via <a href="https://github.com/facebookresearch/hydra" target="_blank" rel="noopener noreferrer">GitHub</a> or the <a href="https://hydra-framework.zulipchat.com/" target="_blank" rel="noopener noreferrer">Hydra Chat</a>.</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/hydra">Hydra</a><a class="margin-horiz--sm" href="/blog/tags/ray">Ray</a><a class="margin-horiz--sm" href="/blog/tags/plugin">Plugin</a></div></footer></article><div></div><div class="margin-vert--xl"><nav class="pagination-nav" aria-label="Blog post page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2020/09/03/Hydra_1.0"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Hydra 1.0 ¬ª</div></a></div></nav></div></div><div class="col col--2"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#launching-to-a-new-or-existing-aws-cluster" class="table-of-contents__link">Launching to a new or existing AWS cluster</a></li><li><a href="#launching-to-a-new-local-ray-cluster" class="table-of-contents__link">Launching to a new local Ray Cluster</a></li><li><a href="#launching-to-an-existing-local-ray-cluster" class="table-of-contents__link">Launching to an existing local Ray Cluster</a></li><li><a href="#parameter-sweeps-and-optimization" class="table-of-contents__link">Parameter sweeps and optimization</a></li><li><a href="#config-type-safety" class="table-of-contents__link">Config type safety</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Links</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/Blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Docs</a></li><li class="footer__item"><a href="https://github.com/facebookresearch/hydra" target="_blank" rel="noopener noreferrer" class="footer__link-item">Hydra@GitHub</a></li><li class="footer__item"><a href="https://github.com/omry/omegaconf" target="_blank" rel="noopener noreferrer" class="footer__link-item">Powered by OmegaConf</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Legal</h4><ul class="footer__items"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noreferrer noopener" class="footer__link-item">Privacy</a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noreferrer noopener" class="footer__link-item">Terms</a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/cookie-policy" target="_blank" rel="noreferrer noopener" class="footer__link-item">Cookies</a></li></ul></div></div><div class="text--center"><div class="margin-bottom--sm"><img class="footer__logo" alt="Facebook Open Source Logo" src="https://docusaurus.io/img/oss_logo.png"></div><div>Copyright ¬© 2021 Facebook, Inc.</div></div></div></footer></div>
<script src="/styles.ef4286b7.js"></script>
<script src="/runtime~main.35e28769.js"></script>
<script src="/main.400321a3.js"></script>
<script src="/1.9ca0e889.js"></script>
<script src="/2.1bf42f32.js"></script>
<script src="/3.974e98df.js"></script>
<script src="/ccc49370.6ea934d4.js"></script>
<script src="/44267b07.43e76fc4.js"></script>
</body>
</html>